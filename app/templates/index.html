{% extends "layout.html" %}

{% block title %}Dashboard - Image Processor{% endblock %}

{% block content %}
<div class="container">
  <div class="top-bar">
    <h1>Image Processor Dashboard</h1>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>

  <hr class="divider">

  <!-- Upload -->
  <div class="card">
    <div class="card-header">
      <h2>Upload Image</h2>
    </div>
    <form onsubmit="uploadFile(event)">
      <input id="file" type="file" required>
      <button type="submit">Upload</button>
    </form>
  </div>

  <!-- Stress test -->
  <div class="card" id="stress-card">
    <div class="card-header">
      <h2>Stress Test (Admin Only)</h2>
    </div>
    <label for="stress-file">Select File</label>
    <select id="stress-file"></select>

    <label for="duration">Duration (seconds)</label>
    <input id="duration" type="number" value="10" min="1">

    <button onclick="stressTest()">Run Stress Test</button>
  </div>

  <!-- Uploaded files -->
  <div class="card">
    <div class="results-header">
      <h2>Uploaded Files</h2>
      <div class="results-actions">
        <button id="settings-btn" onclick="openSettings()">âš™ Settings</button>
        <button id="clear-uploads-btn" class="danger-btn" onclick="clearUploads()">ðŸ—‘ Delete All Uploads</button>
      </div>
    </div>

    <div class="filter-bar">
      <input id="uploads-filter-input" type="text" placeholder="Search uploads...">
      <button class="filter-btn" onclick="applyUploadsFilter()">Filter</button>
    </div>

    <div id="uploads-list"></div>
    <div id="uploads-pagination" class="pagination"></div>
  </div>

  <!-- Results -->
  <div class="card results-card">
    <div class="results-header">
      <h2>Results</h2>
      <div class="results-actions">
        <button id="clear-data-btn" class="danger-btn" onclick="clearData()">ðŸ—‘ Delete All Data</button>
      </div>
    </div>

    <div class="filter-bar">
      <input id="filter-input" type="text" placeholder="Search results...">
      <button class="filter-btn" onclick="applyFilter()">Filter</button>
    </div>

    <div id="results-container">
      <div id="results"></div>
      <div id="pagination" class="pagination"></div>
    </div>
  </div>
</div>

<!-- Settings Modal -->
<div id="settings-modal" class="modal">
  <div class="modal-content">
    <h2>Processing Settings</h2>
    <label>Rotate (degrees): <input type="number" id="rotate" value="0"></label><br>
    <label>Blur (radius): <input type="number" id="blur" value="0" step="0.5"></label><br>
    <label>Upscale factor: <input type="number" id="upscale" value="1" step="0.1" min="1"></label><br>
    <label>Resize width: <input type="number" id="resize-width" placeholder="auto"></label><br>
    <label>Resize height: <input type="number" id="resize-height" placeholder="auto"></label><br>
    <label><input type="checkbox" id="grayscale"> Grayscale</label><br>
    <label>Flip: 
      <select id="flip">
        <option value="">None</option>
        <option value="horizontal">Horizontal</option>
        <option value="vertical">Vertical</option>
      </select>
    </label><br><br>
    <button onclick="saveSettings()">Save</button>
    <button onclick="closeSettings()">Close</button>
  </div>
</div>

<!-- External JavaScript -->
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}